---
id: migration_to_v6
title: Migration to v6
---

## Updates to cache

Cache no longer returns records as maps.
All methods interacting with cache are now returning plain objects instead of `Map`.

```ts
tolgee.loadRecords(): Promise<CacheInternalRecord[]>
tolgee.loadRecord(): Promise<CacheInternalRecord>
tolgee.getRecord(): CacheInternalRecord
tolgee.getAllRecords(): CacheInternalRecord[]
```

Returned cache record(s) are now unified like this:
```ts
type CacheInternalRecord = {
  data: Record<string, string | undefined | null>; // replaces Map()
  language: string;
  namespace: string;
  cacheKey: string;
};
```

## Updated `getRequiredRecords`

This function was renamed to `getRequiredDescriptors`, because it's not returning data from cache,
but description (descriptors) of what need to be in cache. Previous naming might be confusing.

```ts
tolgee.getRequiredDescriptors(lang?: string, ns?: NsFallback): CacheDescriptorInternal[]
```

Previously the method returned the descriptors that are missing in the cache, but now we are returning
all records that are required to be in the cache, so it works the same regardless what is currently in cache.

Previous behavior can be achieved by comparing the cache content with the results of this function.

## Removed obscure `onNsUpdate` subscribing

Previously it was possible to subscribe to specific namespace changes like this:

```ts
const listener = tolgee.onNsUpdate(...)
// subscribes namespace
listener.subscribeNs(ns)
// unsubscribe completely
listener.unsubscribe()
```

You can replace that with `update` event.

```ts
tolgee.on('update', ...)
```

If you want to only react to certain namespaces, the event handler recieves an array of events which
led to invocation of `update` event (`update` is derrived from other events).

```ts
tolgee.on('update', (events) => {
  if (events.every(e => (e.type !== 'cache' || e.value.namespace === 'namespace'))) {
    handler()
  }
})
```

## React

`TolgeeProvider` component `useSuspense` is now false by default.

## Vue
